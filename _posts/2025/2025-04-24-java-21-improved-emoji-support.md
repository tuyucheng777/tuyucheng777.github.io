---
layout: post
title:  Javaè¡¨æƒ…ç¬¦å·æ”¯æŒæ”¹è¿›
category: java-new
copyright: java-new
excerpt: Java 21
---

## 1. æ¦‚è¿°

[Java 21](https://www.baeldung.com/java-lts-21-new-features)åœ¨java.lang.Characterç±»ä¸­å¼•å…¥äº†ä¸€ç»„æ–°æ–¹æ³•ï¼Œ**ä»¥ä¾¿ä¸ºè¡¨æƒ…ç¬¦å·æä¾›æ›´å¥½çš„æ”¯æŒï¼Œè¿™äº›æ–¹æ³•ä½¿æˆ‘ä»¬èƒ½å¤Ÿè½»æ¾æ£€æŸ¥æŸä¸ªå­—ç¬¦æ˜¯å¦æ˜¯è¡¨æƒ…ç¬¦å·ï¼Œå¹¶æ£€æŸ¥è¡¨æƒ…ç¬¦å·å­—ç¬¦çš„å±æ€§å’Œç‰¹å¾**ã€‚

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†æ¢ç´¢æ–°æ·»åŠ çš„æ–¹æ³•å¹¶ä»‹ç»ä¸Java 21ä¸­è¡¨æƒ…ç¬¦å·å¤„ç†ç›¸å…³çš„å…³é”®æ¦‚å¿µã€‚

## 2. Character APIæ›´æ–°

Java 21åœ¨java.lang.Characterç±»ä¸­å¼•å…¥äº†6ä¸ªä¸è¡¨æƒ…ç¬¦å·å¤„ç†ç›¸å…³çš„æ–°æ–¹æ³•ï¼Œ**æ‰€æœ‰æ–°æ–¹æ³•éƒ½æ˜¯é™æ€çš„ï¼Œä»¥è¡¨ç¤ºå­—ç¬¦çš„Unicode[ä»£ç ç‚¹](https://www.baeldung.com/java-char-encoding#3-code-point)çš„intä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›booleanå€¼**ã€‚

[Unicodeä»£ç ç‚¹](https://www.baeldung.com/cs/unicode-encodings)æ˜¯Unicodeæ ‡å‡†ä¸­ä¸ºæ¯ä¸ªå­—ç¬¦åˆ†é…çš„å”¯ä¸€æ•°å€¼ï¼Œå®ƒä»£è¡¨ä¸åŒå¹³å°å’Œè¯­è¨€çš„ç‰¹å®šå­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œä»£ç ç‚¹U+0041ä»£è¡¨å­—æ¯â€œAâ€ï¼Œåå…­è¿›åˆ¶å½¢å¼ä¸º0x0041ã€‚

Unicodeè”ç›Ÿæ˜¯ä¸€å®¶éè¥åˆ©æ€§å…¬å¸ï¼Œè´Ÿè´£ç»´æŠ¤å’Œå¼€å‘Unicodeæ ‡å‡†ï¼Œå¹¶æä¾›è¡¨æƒ…ç¬¦å·åŠå…¶å¯¹åº”Unicodeä»£ç ç‚¹çš„[å®Œæ•´åˆ—è¡¨](https://unicode.org/emoji/charts/full-emoji-list.html)ã€‚

ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä»”ç»†çœ‹çœ‹è¿™äº›ä¸è¡¨æƒ…ç¬¦å·ç›¸å…³çš„æ–°æ–¹æ³•ã€‚

### 2.1 isEmoji()

isEmoji(int codePoint)æ–¹æ³•æ˜¯æ–°è¡¨æƒ…ç¬¦å·æ–¹æ³•ä¸­æœ€åŸºæœ¬çš„ä¸€ä¸ªï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªè¡¨ç¤ºå­—ç¬¦Unicodeä»£ç ç‚¹çš„intå€¼ï¼Œå¹¶**è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼ŒæŒ‡ç¤ºè¯¥å­—ç¬¦æ˜¯å¦ä¸ºè¡¨æƒ…ç¬¦å·**ã€‚

æˆ‘ä»¬æ¥çœ‹çœ‹å®ƒçš„ç”¨æ³•ï¼š

```java
String messageWithEmoji = "Hello Java 21! ğŸ˜„";
String messageWithoutEmoji = "Hello Java!";

assertTrue(messageWithEmoji.codePoints().anyMatch(Character::isEmoji));
assertFalse(messageWithoutEmoji.codePoints().anyMatch(Character::isEmoji));
```

### 2.2 isEmojiPresentation()

**isEmojiPresentation(int codePoint)æ–¹æ³•ç¡®å®šå­—ç¬¦æ˜¯å¦åº”å‘ˆç°ä¸ºè¡¨æƒ…ç¬¦å·**ï¼ŒæŸäº›å­—ç¬¦(å¦‚æ•°å­—(0-9)å’Œè´§å¸ç¬¦å·($æˆ–â‚¬)å¯ä»¥æ ¹æ®ä¸Šä¸‹æ–‡å‘ˆç°ä¸ºè¡¨æƒ…ç¬¦å·æˆ–æ–‡æœ¬å­—ç¬¦ã€‚

ä»¥ä¸‹ä»£ç ç‰‡æ®µæ¼”ç¤ºäº†æ­¤æ–¹æ³•çš„ç”¨æ³•ï¼š
```java
String emojiPresentationMessage = "Hello Java 21! ğŸ”¥ğŸ˜„";
String nonEmojiPresentationMessage = "Hello Java 21!";

assertTrue(emojiPresentationMessage.codePoints().anyMatch(Character::isEmojiPresentation));
assertFalse(nonEmojiPresentationMessage.codePoints().anyMatch(Character::isEmojiPresentation));
```

### 2.3 isEmojiModifier()

**isEmojiModifier(int codePoint)æ–¹æ³•æ£€æŸ¥æŸä¸ªå­—ç¬¦æ˜¯å¦ä¸ºè¡¨æƒ…ç¬¦å·ä¿®é¥°ç¬¦ï¼Œè¡¨æƒ…ç¬¦å·ä¿®é¥°ç¬¦æ˜¯å¯ä»¥ä¿®æ”¹ç°æœ‰è¡¨æƒ…ç¬¦å·å¤–è§‚çš„å­—ç¬¦ï¼Œä¾‹å¦‚åº”ç”¨[è‚¤è‰²å˜åŒ–](https://www.w3schools.com/charsets/ref_emoji_skin_tones.asp)**ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä½¿ç”¨è¿™ç§æ–¹æ³•æ¥æ£€æµ‹è¡¨æƒ…ç¬¦å·ä¿®é¥°ç¬¦ï¼š
```java
assertTrue(Character.isEmojiModifier(0x1F3FB)); // light skin tone
assertTrue(Character.isEmojiModifier(0x1F3FD)); // medium skin tone
assertTrue(Character.isEmojiModifier(0x1F3FF)); // dark skin tone
```

åœ¨è¿™ä¸ªæµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨Unicodeä»£ç ç‚¹çš„åå…­è¿›åˆ¶å½¢å¼(ä¾‹å¦‚0x1F3FB)ï¼Œè€Œä¸æ˜¯å®é™…çš„è¡¨æƒ…ç¬¦å·å­—ç¬¦ï¼Œå› ä¸ºè¡¨æƒ…ç¬¦å·ä¿®é¥°ç¬¦é€šå¸¸ä¸ä¼šå‘ˆç°ä¸ºç‹¬ç«‹çš„è¡¨æƒ…ç¬¦å·å¹¶ä¸”ç¼ºä¹è§†è§‰åŒºåˆ«ã€‚

### 2.4 isEmojiModifierBase()

**isEmojiModifierBase(int codePoint)æ–¹æ³•ç¡®å®šè¡¨æƒ…ç¬¦å·ä¿®é¥°ç¬¦æ˜¯å¦å¯ä»¥ä¿®é¥°ç»™å®šå­—ç¬¦**ï¼Œæ­¤æ–¹æ³•æœ‰åŠ©äºè¯†åˆ«æ”¯æŒä¿®é¥°çš„è¡¨æƒ…ç¬¦å·ï¼Œå› ä¸ºå¹¶éæ‰€æœ‰è¡¨æƒ…ç¬¦å·éƒ½å…·æœ‰æ­¤åŠŸèƒ½ã€‚

è®©æˆ‘ä»¬çœ‹ä¸€äº›ä¾‹å­æ¥æ›´å¥½åœ°ç†è§£è¿™ä¸€ç‚¹ï¼š
```java
assertTrue(Character.isEmojiModifierBase(Character.codePointAt("ğŸ‘", 0)));
assertTrue(Character.isEmojiModifierBase(Character.codePointAt("ğŸ‘¶", 0)));
    
assertFalse(Character.isEmojiModifierBase(Character.codePointAt("ğŸ•", 0)));
```

æˆ‘ä»¬çœ‹åˆ°ç«–èµ·å¤§æ‹‡æŒ‡çš„è¡¨æƒ…ç¬¦å·â€œğŸ‘â€å’Œå©´å„¿è¡¨æƒ…ç¬¦å·â€œğŸ‘¶â€æ˜¯æœ‰æ•ˆçš„è¡¨æƒ…ä¿®é¥°åŸºç¡€ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡åº”ç”¨è‚¤è‰²å˜åŒ–æ¥æ”¹å˜å…¶å¤–è§‚ï¼Œä»è€Œè¡¨è¾¾å¤šæ ·æ€§ã€‚

å¦ä¸€æ–¹é¢ï¼ŒæŠ«è¨è¡¨æƒ…ç¬¦å·â€œğŸ•â€ä¸ç¬¦åˆæœ‰æ•ˆè¡¨æƒ…ç¬¦å·ä¿®é¥°åŸºç¡€çš„æ¡ä»¶ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è¡¨æƒ…ç¬¦å·ï¼Œä»£è¡¨ä¸€ä¸ªç‰©ä½“ï¼Œè€Œä¸æ˜¯å¯ä»¥ä¿®æ”¹å¤–è§‚çš„å­—ç¬¦æˆ–ç¬¦å·ã€‚

### 2.5 isEmojiComponent()

**isEmojiComponent(int codePoint)æ–¹æ³•æ£€æŸ¥æŸä¸ªå­—ç¬¦æ˜¯å¦å¯ä»¥ç”¨ä½œåˆ›å»ºæ–°è¡¨æƒ…ç¬¦å·çš„ç»„ä»¶**ï¼Œè¿™äº›å­—ç¬¦é€šå¸¸ä¸å…¶ä»–å­—ç¬¦ç»„åˆå½¢æˆæ–°çš„è¡¨æƒ…ç¬¦å·ï¼Œè€Œä¸æ˜¯ä½œä¸ºç‹¬ç«‹çš„è¡¨æƒ…ç¬¦å·å‡ºç°ã€‚

ä¾‹å¦‚ï¼Œ**[é›¶å®½åº¦è¿æ¥ç¬¦](https://en.wikipedia.org/wiki/Zero-width_joiner)(ZWJ)æ˜¯ä¸€ç§éæ‰“å°å­—ç¬¦ï¼Œå®ƒå‘æ¸²æŸ“ç³»ç»ŸæŒ‡ç¤ºç›¸é‚»å­—ç¬¦åº”æ˜¾ç¤ºä¸ºå•ä¸ªè¡¨æƒ…ç¬¦å·**ã€‚é€šè¿‡ä½¿ç”¨é›¶å®½åº¦è¿æ¥ç¬¦(0x200D)å°†ç”·äººè¡¨æƒ…ç¬¦å·â€œğŸ‘¨â€(0x1F468)å’Œç«ç®­è¡¨æƒ…ç¬¦å·â€œğŸš€â€(0x1F680)ç»„åˆèµ·æ¥ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„å®‡èˆªå‘˜è¡¨æƒ…ç¬¦å·â€œğŸ‘¨â€ğŸš€â€ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨[Unicodeä»£ç è½¬æ¢å™¨](https://r12a.github.io/app-conversion/)ç½‘ç«™é€šè¿‡è¾“å…¥è¿›è¡Œæµ‹è¯•ï¼š0x1F4680x200D0x1F680ã€‚

**è‚¤è‰²å­—ç¬¦ä¹Ÿæ˜¯è¡¨æƒ…ç¬¦å·çš„ç»„æˆéƒ¨åˆ†**ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ·±è‰²è‚¤è‰²å­—ç¬¦(0x1F3FF)ä¸æŒ¥æ‰‹è¡¨æƒ…ç¬¦å·â€œğŸ‘‹â€(0x1F44B)ç»“åˆèµ·æ¥ï¼Œåˆ›å»ºä¸€ä¸ªæ·±è‰²è‚¤è‰²çš„æŒ¥æ‰‹â€œğŸ‘‹ğŸ¿â€(0x1F44B0x1F3FF)ã€‚ç”±äºæˆ‘ä»¬ä¿®æ”¹çš„æ˜¯ç°æœ‰è¡¨æƒ…ç¬¦å·çš„å¤–è§‚ï¼Œè€Œä¸æ˜¯åˆ›å»ºæ–°çš„è¡¨æƒ…ç¬¦å·ï¼Œå› æ­¤æˆ‘ä»¬ä¸éœ€è¦ä½¿ç”¨ZWJå­—ç¬¦æ¥æ”¹å˜è‚¤è‰²ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹å®ƒçš„ç”¨æ³•å¹¶åœ¨æˆ‘ä»¬çš„ä»£ç ä¸­æ£€æµ‹è¡¨æƒ…ç¬¦å·ç»„ä»¶ï¼š
```java
assertTrue(Character.isEmojiComponent(0x200D)); // Zero width joiner
assertTrue(Character.isEmojiComponent(0x1F3FD)); // medium skin tone
```

### 2.6 isExtendedPictographic()

**isExtendedPictographic(int codePoint)æ–¹æ³•æ£€æŸ¥æŸä¸ªå­—ç¬¦æ˜¯å¦å±äºè±¡å½¢ç¬¦å·çš„æ›´å¹¿æ³›ç±»åˆ«**ï¼Œè¯¥ç±»åˆ«ä¸ä»…åŒ…æ‹¬ä¼ ç»Ÿçš„è¡¨æƒ…ç¬¦å·ï¼Œè¿˜åŒ…æ‹¬é€šå¸¸ç”±æ–‡æœ¬å¤„ç†ç³»ç»Ÿä»¥ä¸åŒæ–¹å¼å‘ˆç°çš„å…¶ä»–ç¬¦å·ã€‚

**ç‰©ä½“ã€åŠ¨ç‰©å’Œå…¶ä»–å›¾å½¢ç¬¦å·å…·æœ‰æ‰©å±•çš„è±¡å½¢æ–‡å­—å±æ€§**ã€‚è™½ç„¶å®ƒä»¬å¹¶ä¸æ€»æ˜¯è¢«è§†ä¸ºå…¸å‹çš„è¡¨æƒ…ç¬¦å·ï¼Œä½†å®ƒä»¬éœ€è¦ä½œä¸ºè¡¨æƒ…ç¬¦å·é›†çš„ä¸€éƒ¨åˆ†è¿›è¡Œè¯†åˆ«å’Œå¤„ç†ï¼Œä»¥ç¡®ä¿æ­£ç¡®æ˜¾ç¤ºã€‚

ä»¥ä¸‹ç¤ºä¾‹æ¼”ç¤ºäº†æ­¤æ–¹æ³•çš„ç”¨æ³•ï¼š
```java
assertTrue(Character.isExtendedPictographic(Character.codePointAt("â˜€ï¸", 0)));  // Sun with rays
assertTrue(Character.isExtendedPictographic(Character.codePointAt("âœ”ï¸", 0)));  // Checkmark
```

å¦‚æœä¼ é€’ç»™isEmojiPresentation()æ–¹æ³•ï¼Œä¸Šè¿°ä¸¤ä¸ªä»£ç ç‚¹å‡è¿”å›falseï¼Œå› ä¸ºå®ƒä»¬å±äºæ›´å¹¿æ³›çš„æ‰©å±•è±¡å½¢æ–‡å­—ç±»åˆ«ï¼Œä½†æ²¡æœ‰è¡¨æƒ…ç¬¦å·è¡¨ç¤ºå±æ€§ã€‚

## 3. æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„è¡¨æƒ…ç¬¦å·æ”¯æŒ

é™¤äº†æ–°çš„è¡¨æƒ…ç¬¦å·æ–¹æ³•ä¹‹å¤–ï¼ŒJava 21è¿˜åœ¨[æ­£åˆ™è¡¨è¾¾å¼](https://www.baeldung.com/regular-expressions-java)ä¸­å¼•å…¥äº†è¡¨æƒ…ç¬¦å·æ”¯æŒã€‚æˆ‘ä»¬ç°åœ¨å¯ä»¥ä½¿ç”¨\\p{IsXXXX}æ„é€ æ ¹æ®è¡¨æƒ…ç¬¦å·å±æ€§åŒ¹é…å­—ç¬¦ã€‚

è®©æˆ‘ä»¬ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åœ¨å­—ç¬¦ä¸²ä¸­æœç´¢ä»»ä½•è¡¨æƒ…ç¬¦å·ï¼š
```java
String messageWithEmoji = "Hello Java 21! ğŸ˜„";
Matcher isEmojiMatcher = Pattern.compile("\\p{IsEmoji}").matcher(messageWithEmoji);
    
assertTrue(isEmojiMatcher.find());

String messageWithoutEmoji = "Hello Java!";
isEmojiMatcher = Pattern.compile("\\p{IsEmoji}").matcher(messageWithoutEmoji);
    
assertFalse(isEmojiMatcher.find());
```

ç±»ä¼¼åœ°ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ä½¿ç”¨å…¶ä»–è¡¨æƒ…ç¬¦å·æ„é€ ï¼š

- IsEmoji_Presentation
- IsEmoji_Modifier
- IsEmoji_Modifier_Base
- IsEmoji_Component
- IsExtended_Pictographic

**éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­£åˆ™è¡¨è¾¾å¼å±æ€§æ„é€ ä½¿ç”¨è›‡å½¢å‘½åæ ¼å¼æ¥å¼•ç”¨æ–¹æ³•ï¼Œè¿™ä¸Characterç±»ä¸­çš„é™æ€æ–¹æ³•ä½¿ç”¨çš„é©¼å³°å‘½åæ ¼å¼ä¸åŒ**ã€‚

è¿™äº›æ­£åˆ™è¡¨è¾¾å¼æ„é€ æä¾›äº†ä¸€ç§å¹²å‡€ã€ç®€å•çš„æ–¹æ³•æ¥æœç´¢å’Œæ“ä½œå­—ç¬¦ä¸²ä¸­çš„è¡¨æƒ…ç¬¦å·ã€‚

## 4. æ€»ç»“

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æ¢è®¨äº†Java 21çš„Characterç±»ä¸­å¼•å…¥çš„æ–°çš„è¡¨æƒ…ç¬¦å·ç›¸å…³æ–¹æ³•ï¼Œæˆ‘ä»¬é€šè¿‡æŸ¥çœ‹å„ç§ç¤ºä¾‹äº†è§£äº†è¿™äº›é™æ€æ–¹æ³•çš„è¡Œä¸ºã€‚

æˆ‘ä»¬è¿˜è®¨è®ºäº†æ­£åˆ™è¡¨è¾¾å¼ä¸­æ–°æ·»åŠ çš„è¡¨æƒ…ç¬¦å·æ”¯æŒï¼Œä»¥ä¾¿ä½¿ç”¨Patternç±»æœç´¢è¡¨æƒ…ç¬¦å·å­—ç¬¦åŠå…¶å±æ€§ã€‚

å½“æˆ‘ä»¬æ„å»ºèŠå¤©åº”ç”¨ç¨‹åºã€ç¤¾äº¤åª’ä½“å¹³å°æˆ–ä»»ä½•å…¶ä»–ä½¿ç”¨è¡¨æƒ…ç¬¦å·çš„åº”ç”¨ç¨‹åºæ—¶ï¼Œè¿™äº›æ–°åŠŸèƒ½å¯ä»¥ä¸ºæˆ‘ä»¬æä¾›å¸®åŠ©ã€‚